# Canonical Intel Report JSON Schema

**Date**: July 2, 2025  
**Generated by**: GitHub Copilot AI Agent

This schema defines the canonical structure for all intelligence-report artifacts, whether stored as JSON, embedded in Markdown front-matter, persisted on-chain, or exchanged via APIs.

```jsonc
{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "title": "IntelReport",
  "description": "Schema for intelligence report metadata and content",
  "type": "object",
  "properties": {
    "id": {
      "type": "string",
      "description": "Unique report identifier (UUID or on-chain account key)"
    },
    "title": {
      "type": "string",
      "maxLength": 256,
      "description": "Descriptive title of the intel report"
    },
    "content": {
      "type": "string",
      "description": "Main body of the report; redact sensitive details as needed"
    },
    "tags": {
      "type": "array",
      "items": { "type": "string" },
      "minItems": 1,
      "description": "Classification tags (e.g., SIGINT, HUMINT)"
    },
    "location": {
      "type": "object",
      "properties": {
        "latitude": { "type": "number", "minimum": -90, "maximum": 90 },
        "longitude": { "type": "number", "minimum": -180, "maximum": 180 }
      },
      "required": ["latitude", "longitude"],
      "description": "Geolocation of the intelligence event"
    },
    "timestamp": {
      "type": "string",
      "format": "date-time",
      "description": "ISO 8601 timestamp of report creation or event time"
    },
    "author": {
      "type": "object",
      "properties": {
        "name": { "type": "string" },
        "wallet": { "type": "string", "pattern": "^0x[a-fA-F0-9]{40}$" }
      },
      "required": ["wallet"],
      "description": "Author identity, at minimum a wallet address"
    },
    "version": {
      "type": "string",
      "description": "Semantic version or hash tag for immutable history"
    }
  },
  "required": ["id", "title", "content", "tags", "location", "timestamp", "author"],
  "additionalProperties": false
}
```

## Validation Notes
- Markdown reports should include a YAML front-matter section matching these properties before the `---` delimiter.
- On-chain Rust `IntelReport` struct maps to JSON fields (`content` may be redacted).
- `.glb` assets should embed the `id` in filename and reference the same schema for metadata.
- Cached JSON (`cache/code-summary.json`) must conform per entry under `intelReports`.

## Next Steps
1. Write a script (`scripts/validate-intel-schema.ts`) to read each source and validate against this schema.  
2. Integrate `ajv` or similar into `npm run audit:reports` to fail CI on violations.  
3. Update existing Markdown and JSON artifacts to include missing fields (`id`, `version`).
